250708 9:34
JPA í˜¹ì€ React ë°°ìš°ê¸° ì „ì—” thymeleafë¡œ ì„œë²„ í•˜ë‚˜ (ì˜ˆ.8080)ë¡œ
í”„ë¡ íŠ¸ì—”ë“œë¥¼ ë‹¤ í–ˆìŒ
ìŠ¤í”„ë§ ì„¸íë¦¬í‹°ì—ì„œëŠ” ì„œë²„ë¥¼ í•˜ë‚˜ ë” ë”°ë¡œ ì¨ì„œ (CSR, 8080 ì™¸)
ë³´ì•ˆì„ ìœ ì§€(?)í•¨.

1. ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦
ì–¸ì œ ì“°ëƒ? í”„ë¡ íŠ¸ì—”ë“œ ë”°ë¡œ ì—†ëŠ” ì„œë¸Œì‚¬ì´ë“œ ë Œë”ë§ êµ¬ì¡°ì—ì„œ ë³´í†µ ì‚¬ìš©í•¨

2. JWT ì œì´ìŠ¨ ì›¹ í† í°
ì–¸ì œ ì‚¬ìš©? íŒ€í”„ë¡œì íŠ¸ ìƒí™©ì²˜ëŸ¼ ì„¸ì…˜ ê³µìœ  ë¶ˆê°€í•œ í”„ë¡ íŠ¸ì—”ë“œ/ë°±ì—”ë“œ ë”°ë¡œ ìˆëŠ” ê²½ìš°
JWTí† í°ì€ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë³´í†µ ì¿ í‚¤ ë“±ì— ì €ì¥ì´ ëœë‹¤.

ì˜ˆë¯¼í•œ ì •ë³´(ì£¼ë¯¼ë²ˆí˜¸ ë“±)ì€ í† í°ì— ë‹´ì§€ ì•ŠëŠ”ë‹¤.
ìŠ¤í”„ë§ ì„¸íë¦¬í‹°ì˜ secret keyë•ë¶„ì— tokenì— 
ê°€ì§œ adminì •ë³´ ë“±ì´ ë‹´ê²¨ì„œ ì˜¤ë”ë¼ë„ ê±°ë¥´ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤.

JWT í† í°ì€ 3ê°€ì§€ë¡œ êµ¬ë¶„ëœë‹¤.
1. Header 2. Payload 3. Signiture

í† í° ì˜ˆì‹œ Bearer tokenë¬¸ìì—´ë¸”ë¼ë¸”ë¼

* ì¶”ì²œ: Refresh token í”„ë¡œì íŠ¸ì—ì„œ êµ¬í˜„í•´ë³´ê¸°
(ìˆ˜ì—…ì‹œê°„ì— ë°°ìš°ì§„ ì•Šì„ê±°ì„. ìˆ˜ì—… ë• Access tokenë§Œ ì‚¬ìš©)

ì‹œíë¦¬í‹° ì•„í‚¤í…ì²˜ëŠ” ë™ì¼
1. Authen-Filterì—ì„œ Tokenì„ì‹œ ë°œê¸‰
2. ......
ì„¸íë¦¬í‹° ì½˜í…ìŠ¤íŠ¸ì— ì €ì¥...

* JWT ê´€ë ¨ ë¡œì§ì€ common/utils/TokenUtilsì— ë“¤ì–´ê°€ ìˆìŒ


"RESTfulí•œ ê°œë°œ???"
Reference :
https://lob-dev.tistory.com/90
https://nbcamp.spartacodingclub.kr/blog/%EA%B0%9C%EB%85%90-%EC%BD%95-%EC%9B%B9-%EA%B0%9C%EB%B0%9C-%EC%A7%80%EC%8B%9D-%ED%8E%B8-restful%ED%95%9C-api-%EC%84%A4%EA%B3%84%EB%B2%95-21182
https://blog.naver.com/chowin21/220706118396

í”„ë¡ íŠ¸ì—”ë“œ ë°±ì—”ë“œ í¬íŠ¸ê°€ ë‹¤ë¥´ë©´ êµì°¨ ì¸¡ì •ì— ëŒ€í•œ í•„í„°ë¥¼ ì„¤ì •í•´ì¤˜ì•¼í•œë‹¤.
-> í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œì˜ í¬íŠ¸ê°€ ë‹¤ë¥´ë©´ ì„œë¡œ ë‹¤ë¥¸ ì¶œì²˜ë¡œ ê°„ì£¼ë˜ë¯€ë¡œ
CORS(Cross-Origin Resource Sharing) ì„¤ì •ì„ í†µí•´ ìš”ì²­ì„ í—ˆìš©í•´ì¤˜ì•¼ í•¨.
Spring Securityë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, CORS ì„¤ì •ì„ Security Filterì— ë°˜ì˜í•´ì•¼ ì •ìƒ ì‘ë™í•¨.

# í†  ê¸°ë°˜ ì¸ì¦ì—ì„œ bearerëŠ” ë¬´ì—‡ì¼ê¹Œ?
https://velog.io/@cada/%ED%86%A0%EA%B7%BC-%EA%B8%B0%EB%B0%98-%EC%9D%B8%EC%A6%9D%EC%97%90%EC%84%9C-bearer%EB%8A%94-%EB%AC%B4%EC%97%87%EC%9D%BC%EA%B9%8C


package com.ohgiraffers.jwtsecurity.auth.config;

import com.ohgiraffers.jwtsecurity.auth.filter.HeaderFilter;
import com.ohgiraffers.jwtsecurity.auth.interceptor.JwtTokenInterceptor;
import org.springframework.boot.web.servlet.FilterRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

/*
* Web configurationì„ ìœ„í•œ í´ë˜ìŠ¤
* */
@Configuration
@EnableWebMvc
public class WebConfig implements WebMvcConfigurer {

    private static final String[] CLASSPATH_RESOURCE_LOCATIONS = {
            "classpath:/static/", "classpath:/public/", "classpath:/", "classpath:/resources/",
            "classpath:/META-INF/resources/", "classpath:/META-INF/resources/webjars/"
    };

    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {
        //ì •ì ìì› ì„ ì–¸í•´ë†“ì€ ê±¸ CLASSPATH_RESOURCE_LOCATIONSì— ë“±ë¡í•´ì¤¬ë‹¤. 9:49
        /*ì •ì  ìì›ì— ëŒ€í•´ ì ‘ê·¼ í—ˆìš© 9:50*/
        registry.addResourceHandler("**").addResourceLocations(CLASSPATH_RESOURCE_LOCATIONS);
    }

    @Bean
    public FilterRegistrationBean<HeaderFilter> getFilterRegistrationBean() {
        //beanìœ¼ë¡œ ë“±ë¡, new FilterRegistrationBean bean ìƒì„±í•  ë•Œ Filterê°’(?)ì„ ë„£ì„ ìˆ˜ ìˆìŒ  9:51
        //ì•„ë˜ì—ì„œ ë„£ì€ HeaderFilterëŠ” CORS ì„¤ì •ì„ ìœ„í•œ filter ì„¤ì • í´ë˜ìŠ¤, ìœ„ì¡° ì‚¬ì´íŠ¸ ê³µê²©ì„ ë§‰ê¸°ìœ„í•´ ì„¤ì •í•´ì£¼ëŠ” í•„í„°
        FilterRegistrationBean<HeaderFilter> registrationBean = new FilterRegistrationBean<HeaderFilter>(createHeaderFilter());
        registrationBean.setOrder(Integer.MIN_VALUE);
        registrationBean.addUrlPatterns("/*");
        return registrationBean;
    }

    @Bean
    public HeaderFilter createHeaderFilter() {
        return new HeaderFilter();
    }

    @Bean
    public JwtTokenInterceptor jwtTokenInterceptor() {
        return new JwtTokenInterceptor();
    }
}

package com.ohgiraffers.jwtsecurity.auth.filter;

import jakarta.servlet.*;
import jakarta.servlet.http.HttpServletResponse;

import java.io.IOException;

/*
 * CORS ì„¤ì •ì„ ìœ„í•œ filter ì„¤ì • í´ë˜ìŠ¤
 * ìœ„ì¡° ì‚¬ì´íŠ¸ ê³µê²©ì„ ë§‰ê¸°ìœ„í•´ ì„¤ì •í•´ì£¼ëŠ” í•„í„°
 * */
public class HeaderFilter implements Filter {
    //implements Filterë¥¼ í–ˆë‹¤ë©´ doFilterë¥¼ ê°•ì œë¡œ ì˜¤ë²„ë¼ì´ë”©í•´ì•¼í•œë‹¤.  9:53
    @Override
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {
        HttpServletResponse res = (HttpServletResponse) servletResponse; //ì›¹ ìºìŠ¤íŒ… í˜•ì‹ì— ë§ì¶”ê¸° ìœ„í•´ ë‹¤ìš´ìºìŠ¤íŒ…í•¨ 9:53(2)

        res.setHeader("Access-Control-Allow-Origin", "*");                          // ë‹¤ë¥¸ ì™¸ë¶€ ìš”ì²­ì˜ ì‘ë‹µì„ í—ˆìš©í•  ê²ƒì¸ê°€?
        res.setHeader("Access-Control-Allow-Methods", "GET, POST, PUT, DELETE");    // ì™¸ë¶€ ìš”ì²­ì— í—ˆìš©í•  ë©”ì†Œë“œ
        res.setHeader("Access-Control-Max-Age", "3600");                            // ìºì‹±ì„ í—ˆìš©í•  ì‹œê°„ (3600= 1ì‹œê°„)
        res.setHeader("Access-Control-Allow-Headers",                                   // ìš”ì²­ ì‹œì— í—ˆìš©í•  header íƒ€ì…
                "X-Requested-With, Content-Type, Authorization, X-XSRF-token");
        res.setHeader("Access-Control-Allow-Credentials", "false");                 // ìê²© ì¦ëª…ì„ í—ˆìš©í•  ê²ƒì¸ê°€?
        //ìš°ë¦¬ê°€ ë§Œë“  ìê²©ì¦ëª…ì„ ì´ìš©í•  ê²ƒì´ê¸° ë•Œë¬¸ì— ìê²©ì¦ëª… falseë¡œ ë§‰ëŠ”ë‹¤. 9:55

        filterChain.doFilter(servletRequest, res);
        //dofilter() = í•„í„°ë¥¼ ê±¸ê±°ë‚˜, ë°˜í™˜ê°’ì„ ê°€ì ¸ì™€.  9:56
    }
}

* JWT ìƒì„±/ë°˜í™˜ë§Œ í•˜ëŠ” ê±´ spring securityë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì´ë‹¤. ì£¼ì˜.  11:56


# 20250708 Developing Day 2

## 1. Add Read while login in AuthUserSevice
    /*Read : Login
    * IDê°–ê³  íšŒì›ì •ë³´ ì¡°íšŒí•˜ëŠ” method ìƒì„±. ë°˜í™˜ì€ UserDTOë¡œ
    *
    * @param username
    * @return
    * @throws */
    public LoginUserDTO findByUsername(String username) {
        if(!Objects.isNull(login)){
            return login;
        }else {
            return null;
        }
    }

## 2. Test at AuthUserServiceTests
    @Test
    @DisplayName("Read ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸")
    void loginUserTest() {
    //given
    LoginUserDTO newLogin = new LoginUserDTO();
    newLogin.setUserId("user03");
    newLogin.setUserPwd("pass03");

    //when
    LoginUserDTO checkLoggedIn = authUserService.findByUserId("user03");

    //then
    assertNotNull(checkLoggedIn);
    assertEquals("user03", newLogin.getUserId());
    assertEquals("pass03", newLogin.getUserPwd());
    }
ë­”ê°€ ì—„ì²­ë‚œ ì–‘ì˜ ì˜¤ë¥˜ê°€ ëœ¸. 

## 3. Edit AuthUserService
    /*Spring-data-jpa: findById (Repositoryì—ì„œ ì œê³µí•´ì£¼ëŠ” ë©”ì†Œë“œ) ì´ìš©í•˜ëŠ” ë°©ë²•*/
    public  LoginUserDTO findUserByUserId(int userCode) {
        User foundUser = authUserRepository.findById(userCode).orElseThrow(IllegalAccessError::new);
        return modelMapper.map(foundUser, LoginUserDTO.class);
    }
    // findByID()ëŠ” Optional<T>ì´ë€ íƒ€ì…ìœ¼ë¡œ ê°ì‹¸ì ¸ìˆë‹¤. ì´ Optional<T>ì€ NullPointExceptionì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ìˆë‹¤.
    // .orElseThrow(IllegalAccessError::new); -> ê°œë°œì í—·ê°ˆë¦¬ê²Œ í•˜ì§€ ë§ê³  ì •í•´ì§„ ì˜¤ë¥˜ IllegalAccessErrorë¥¼ ë°œìƒì‹œì¼œë¼

    // Menu entityë¥¼ DTOë¡œ ë°”ê¿”ì„œ ë°˜í™˜í•´ì•¼í•œë‹¤.
    // ë°©ë²•1. Menuì— ìˆëŠ” ê°’ë“¤ì„ í•˜ë‚˜í•˜ë‚˜ DTOì— ì˜®ê²¨ë‹´ëŠ”ë‹¤ -> ì½”ë“œê°€ ë„ˆë¬´ ë§ì•„ì§€ê³  ë¶ˆí¸í•¨
    // -> ë°©ë²•2. DTOì— í•˜ë‚˜ì”© ë‹´ì•„ì£¼ëŠ” library ì‚¬ìš©
        /*ê°•ì˜ìë£Œ PDF: Menu Entityì— ìˆëŠ” ê°’ì„ getter ë©”ì†Œë“œë¡œ êº¼ë‚´ì„œ MenuDTO ê°ì²´ë¥¼ ìƒì„±í•œ ë’¤
        setter ë©”ì†Œë“œë¡œ ì„¤ì •í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤. í•´ë‹¹ ê³¼ì •ì„ ì§ì ‘ ì‘ì„±í•˜ëŠ” ê²ƒì€ ë²ˆê±°ë¡œìš°ë¯€ë¡œ ModelMapper ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•œë‹¤.*/
    //-> Add  implementation 'org.modelmapper:modelmapper:3.1.1'  into the build.gradle
    //modelMappperì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í•„ìš”í•œ Bean ì„¤ì •íŒŒì¼ í´ë˜ìŠ¤ë¥¼ í•˜ë‚˜ ìƒì„±í•œë‹¤. config package > class BeanConfig
    // foundUser(User entity)ì— ìˆë˜ í•„ë“œ ì¤‘ LoginUserDTOì— ìˆëŠ” í•„ë“œëª…ê³¼ ë˜‘ê°™ì€ ì´ë¦„ì„ ê°€ì§„ í•„ë“œë“¤ì´ LoginUserDTOë¡œ ì˜®ê²¨ê°„ë‹¤.
    // (ModelMapper libraryë¥¼ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•œ ì¼)

## 4. Change a line in AuthUserServiceTests
(Latest)
    
    @Test
    @DisplayName("Read ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸")
    void loginUserTest() {
        //given
        //when
        LoginUserDTO checkLoggedIn = authUserService.findUserByUserId(3);

        //then
        //1. ê³ ê° ì •ë³´ í™•ì¸
        assertNotNull(checkLoggedIn);
        assertNotNull(checkLoggedIn.getUserCode());
        assertNotNull(checkLoggedIn.getUserName());
        assertNotNull(checkLoggedIn.getUserRole().getRole());

        assertEquals("user03", checkLoggedIn.getUserId());
        assertEquals("pwd03", checkLoggedIn.getUserPwd());
        assertEquals("í™ê¸¸ë™", checkLoggedIn.getUserName());
        assertEquals(UserRole.USER, checkLoggedIn.getUserRole());
    }

(Before)

    @Test
    @DisplayName("Read ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸")
    void loginUserTest() {
    //given
    //when
    LoginUserDTO checkLoggedIn = authUserService.findUserByUserId(3);

    //then
    //1. ê³ ê° ì •ë³´ í™•ì¸
    assertNotNull(checkLoggedIn);
    assertNotNull(checkLoggedIn.getUserCode());
    assertNotNull(checkLoggedIn.getUserName());
    assertNotNull(checkLoggedIn.getUserRole().getRole());

    assertEquals("user03", checkLoggedIn.getUserId());
    assertEquals("pwd03", checkLoggedIn.getUserPwd());
    assertEquals("í™ê¸¸ë™", checkLoggedIn.getUserName());
    assertEquals(0, checkLoggedIn.getUserRole());
    }

í˜„ì¬ ìƒí™©ì—ì„œ í•µì‹¬ ë¬¸ì œëŠ” ë‹¤ìŒ í•œ ì¤„ì´ì•¼:

    assertEquals(0, checkLoggedIn.getUserRole());
ğŸ”¥ ë¬¸ì œ í•µì‹¬
userRoleì˜ íƒ€ì…ì€ intê°€ ì•„ë‹ˆë¼ ì•„ë˜ enumì´ì•¼:

    private UserRole userRole;
ê·¸ë¦¬ê³  ì´ UserRole enumì€ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ë¼ ìˆì–´:

    public enum UserRole {
        USER("USER"),
        ADMIN("ADMIN");
    }
â†’ ê·¸ëŸ¬ë‹ˆê¹Œ checkLoggedIn.getUserRole()ì€ UserRole.USER í˜¹ì€ UserRole.ADMIN ì´ ë°˜í™˜ë¼.
ì •ìˆ˜í˜• 0ì´ë‚˜ 1ì´ ì•„ë‹ˆë¼.

âœ… í•´ê²° ë°©ë²• 1: assertEquals() ë¹„êµ ìˆ˜ì •

    assertEquals(UserRole.USER, checkLoggedIn.getUserRole());
â†’ ì´ê²Œ ì •í™•í•œ enum ë¹„êµ ë°©ì‹ì´ì•¼.

ë˜ëŠ” ë¬¸ìì—´ë¡œ ë¹„êµí•˜ê³  ì‹¶ë‹¤ë©´:

    assertEquals("USER", checkLoggedIn.getUserRole().getRole());
âš ï¸ ì°¸ê³ : ë°ì´í„°ë² ì´ìŠ¤ì—ëŠ” is_admin = 0ì´ ì €ì¥ë¼ ìˆìœ¼ë‹ˆ...
User ì—”í‹°í‹°ì—ì„œ userRoleì„ enumìœ¼ë¡œ ë§¤í•‘í•  ë•ŒëŠ” @Enumerated(EnumType.STRING) ë˜ëŠ” @Enumerated(EnumType.ORDINAL)ì„ ì‚¬ìš©í•´ì•¼ í•´.

ë„ˆëŠ” "USER" ë˜ëŠ” "ADMIN" ë¬¸ìì—´ë¡œ ì €ì¥í•˜ê³  ë§¤í•‘í•´ì•¼ í•˜ëŠ” êµ¬ì¡°ì´ë‹ˆ, ì•„ë˜ì²˜ëŸ¼ ë˜ì–´ ìˆì–´ì•¼ í•´:
âœ… User ì—”í‹°í‹° ì˜ˆì‹œ:

    @Enumerated(EnumType.STRING) // ê¼­ ìˆì–´ì•¼ enum <-> DB ë¬¸ìì—´ ë§¤í•‘ ë¨
    private UserRole userRole;

## 5. Revise LoginUserDTO
(Latest)
    
    @Getter
    @Setter
    @ToString
    public class LoginUserDTO {
        private int userCode;
        private String userId;
        private String userPwd;
        private String userName;
        private boolean isAdmin;
        /*@Enumerated(EnumType.STRING)
        @Column(name = "is_admin")
        private UserRole userRole; */
    //ê¸°ë³¸ ìƒì„±ì public LoginUserDTO() {}ëŠ”
    // entityì—ì„œ @NoArgsCons...ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´
    // publicìœ¼ë¡œ ë§Œë“¤ì–´ì§ˆ ìˆ˜ ìˆë„ë¡ ë”°ë¡œ ëª…ì‹œ ì•ˆ í•¨. 13:10
    }

(Before)

    @Getter
    @Setter
    @ToString
    public class LoginUserDTO {
        private int userCode;
        private String userId;
        private String userPwd;
        private String userName;

        @Enumerated(EnumType.STRING)
        @Column(name = "is_admin") // annotation2ê°œ ì¶”ê°€ 16:04
        private UserRole userRole;
        //ê¸°ë³¸ ìƒì„±ì public LoginUserDTO() {}ëŠ”
        // entityì—ì„œ @NoArgsCons...ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´
        // publicìœ¼ë¡œ ë§Œë“¤ì–´ì§ˆ ìˆ˜ ìˆë„ë¡ ë”°ë¡œ ëª…ì‹œ ì•ˆ í•¨. 250707 13:10
    }

## 6. Complete loginUserTest at AuthUserServiceTests
    @Test
    @DisplayName("Read ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸")
    void loginUserTest() {
        //given
        //1. ê³ ê° ì •ë³´ í™•ì¸
        //when
        LoginUserDTO checkLoggedIn = authUserService.findUserByUserId(3);

        //then
        assertNotNull(checkLoggedIn);
        assertNotNull(checkLoggedIn.getUserCode());
        assertNotNull(checkLoggedIn.getUserName());

        assertEquals("user03", checkLoggedIn.getUserId());
        assertEquals("pwd03", checkLoggedIn.getUserPwd());
        assertEquals("í™ê¸¸ë™", checkLoggedIn.getUserName());
        assertFalse(checkLoggedIn.isAdmin());

        //2. ê´€ë¦¬ì ì •ë³´ í™•ì¸
        //when
        LoginUserDTO checkAdmin = authUserService.findUserByUserId(2);

        //then
        assertNotNull(checkAdmin);
        assertNotNull(checkAdmin.getUserCode());
        assertNotNull(checkAdmin.getUserName());

        assertEquals("admin02", checkAdmin.getUserId());
        assertEquals("pwd02", checkAdmin.getUserPwd());
        assertEquals("ê¶Œì€ì§€", checkAdmin.getUserName());
        assertTrue(checkAdmin.isAdmin());
    }
### Test í†µê³¼ ì™„ë£Œ í™•ì¸í•¨ 16:16

## C, R(ìƒì„¸) ì™„ë£Œ -> ì—¬ê¸°ì„œ ì˜ë¬¸. User ì „ì²´ì¡°íšŒ(Rì „ì²´)ëŠ” í•„ìš”ê°€ ì—†ì§€ ì•Šë‚˜?
## CRMì„ ê´€ë¦¬í•  íšŒì‚¬ ì£¼ì²´ê°€ ìˆëŠ” ê²ƒë„ ì•„ë‹ˆê³  ìƒµë³„ ê³ ê°ì¡°íšŒê°€ User ì „ì²´ì¡°íšŒë¥¼ ëŒ€ì‹ í•˜ëŠ” ê±° ê°™ì€ë°...  16:24

## 7. Fix AuthUserService to handle IllegalAccessError
    public  LoginUserDTO findUserByUserId(int userCode) {
        User foundUser = authUserRepository.findById(userCode)
                .orElseThrow(() -> new IllegalAccessError("í•´ë‹¹í•˜ëŠ” íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤. íšŒì›ê°€ì… í›„ ë¡œê·¸ì¸ í•´ì£¼ì‹­ì‹œì˜¤."));
        return modelMapper.map(foundUser, LoginUserDTO.class);
    }

    AuthUserServiceTests{......
    //3. ì¡´ì¬í•˜ì§€ ì•ŠëŠ” userCodeë¡œ ìœ ì € ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
        //when
        LoginUserDTO checkNoUser = authUserService.findUserByUserId(31);

        //then
        assertNull(checkLoggedIn);
        assertNull(checkLoggedIn.getUserCode());
        assertNull(checkLoggedIn.getUserId());
        assertNull(checkLoggedIn.getUserPwd());
        assertNull(checkLoggedIn.getUserName());
        assertNull(checkLoggedIn.isAdmin());
    }
í•´ë‹¹í•˜ëŠ” íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤. íšŒì›ê°€ì… í›„ ë¡œê·¸ì¸ í•´ì£¼ì‹­ì‹œì˜¤.
java.lang.IllegalAccessError: í•´ë‹¹í•˜ëŠ” íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤. íšŒì›ê°€ì… í›„ ë¡œê·¸ì¸ í•´ì£¼ì‹­ì‹œì˜¤.
at com.header.header.domain.auth.model.service.AuthUserService.lambda$findUserByUserId$0(AuthUserService.java:63)
at java.base/java.util.Optional.orElseThrow(Optional.java:403)
at com.header.header.domain.auth.model.service.AuthUserService.findUserByUserId(AuthUserService.java:63)
at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.base/java.lang.reflect.Method.invoke(Method.java:569)
at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)

## 8. [FIX] Add getUserInfo method that using AuthUserDTO under public LoginUserDTO findUserByUserId(int userCode)
    AuthUserServiceTests
    @Test
    @DisplayName("Delete(ë…¼ë¦¬ì  ì‚­ì œ, isLeave=true) í…ŒìŠ¤íŠ¸")
    void leaveTest() {
    //given
    AuthUserDTO checkLeaved = authUserService.findUserByUserId(30); // ì˜¤ë¥˜ ë°œìƒ.

    AuthUserService
    public LoginUserDTO findUserByUserId(int userCode) {
        User foundUser = authUserRepository.findById(userCode)
                .orElseThrow(() -> new IllegalAccessError("í•´ë‹¹í•˜ëŠ” íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤. íšŒì›ê°€ì… í›„ ë¡œê·¸ì¸ í•´ì£¼ì‹­ì‹œì˜¤."));
        return modelMapper.map(foundUser, LoginUserDTO.class);
    }
-> Testì—ì„œëŠ” AutherUserDTOë¥¼ ì“°ëŠ”ë°, authUServiceì—ì„œ ì“°ì¸ findUserByUserIdëŠ”
LoginUserDTOë¥¼ ì“°ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.

AuthUserserviceì—

    public AuthUserDTO getUserInfo(int userCode) {
        User user = authUserRepository.findById(userCode)
                .orElseThrow(() -> new NoSuchElementException("í•´ë‹¹ íšŒì›ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."));
        return modelMapper.map(user, AuthUserDTO.class);
    }
ë¥¼ ì¶”ê°€í–ˆë‹¤.

## 9. Complete delete (logical delete(change isLeave==true from isLeave==false), not a physical delete)
    @Test
    @DisplayName("Delete(ë…¼ë¦¬ì  ì‚­ì œ, isLeave=true) í…ŒìŠ¤íŠ¸")
    void leaveTest() {
        //given
        AuthUserDTO checkLeaved = authUserService.getUserInfo(30);

        //when
        //isLeaveê°€ false(ê¸°ë³¸ê°’)ì´ë¼ë©´
        assertFalse(checkLeaved.isLeave());

        //then
        checkLeaved.setLeave(true);

        assertTrue(checkLeaved.isLeave());
    }
